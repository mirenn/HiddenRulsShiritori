# 開発者向けドキュメント

## セットアップとローカルでの実行方法

### 1. リポジトリのクローンと依存関係のインストール

まず、このリポジトリをローカル環境にクローンします。

```bash
git clone https://github.com/mirenn/HiddenRulsShiritori.git
cd HiddenRuleShiritori
```

次に、プロジェクトのルートディレクトリで以下のコマンドを実行し、必要な依存関係をインストールします。

```bash
npm install
```

### 2. 環境変数の設定

このプロジェクトでは、Gemini API を利用しています。API キーを設定する必要があります。

プロジェクトのルートディレクトリに `.env` ファイルを作成し、以下のように記述してください。

```
GEMINI_API_KEY=YOUR_GEMINI_API_KEY
```

`YOUR_GEMINI_API_KEY` の部分を、ご自身の Gemini API キーに置き換えてください。

もしくは、環境変数として `GEMINI_API_KEY` を設定してください。

また、フロントエンドが接続する WebSocket サーバーの URL を指定するために `VITE_WS_URL` 環境変数が使用されます。

```
VITE_WS_URL=YOUR_WEBSOCKET_SERVER_URL
```

ローカル開発環境では、この変数を設定しない場合、デフォルトで `ws://localhost:3000` に接続されます。アプリケーションを Render などのホスティングサービスにデプロイする際には、この環境変数にデプロイされた WebSocket サーバーの URL を設定する必要があります。

### 3. ローカル環境での実行

アプリケーションをローカル環境で実行する主な手順は、まずプロジェクト全体をビルドし、その後ビルドされたアプリケーションを起動することです。

#### 3.1 ビルド

以下のコマンドを実行して、フロントエンドとサーバーサイドの両方をビルドします。

```bash
npm run build
```

ビルドされたファイルは、フロントエンドが `dist` ディレクトリに、サーバーサイドが `dist_server` ディレクトリに出力されます。

#### 3.2 実行

ビルドが完了したら、以下のコマンドでサーバーを起動します。

```bash
npm start
```

通常、アプリケーションには `http://localhost:3000` でアクセスできます。フロントエンドのファイルは、このサーバーから提供されます。

### 4. 開発時の便利な機能 (補足)

開発を効率的に進めるために、ホットリロードや自動再起動の機能を利用することも可能です。これらを利用する場合は、フロントエンドとサーバーサイドを個別のターミナルで起動します。

#### 4.1 フロントエンドのホットリロード (Vite 開発サーバー)

以下のコマンドを実行すると、フロントエンドの開発サーバーが起動し、コード変更時にブラウザが自動的にリロードされます。

```bash
npm run dev
```

この場合、フロントエンドは通常 `http://localhost:5173` でアクセスできます。サーバーサイドは別途起動する必要があります。

#### 4.2 サーバーサイドの自動再起動

以下のコマンドを実行すると、サーバーサイドのアプリケーションが起動し、ファイルの変更を監視して自動的に再起動します。

```bash
npm run start:server
```

この場合、サーバーは通常 `http://localhost:3000` で起動します。フロントエンドは別途 `npm run dev` で起動するか、`npm run build` でビルドしたものを参照するように設定します。
